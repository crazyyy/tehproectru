/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


window[esri._dojoScopeName||"dojo"]._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dijit.Menu"],["require","dojo.window"],["require","dijit._Widget"],["require","dijit._KeyNavContainer"],["require","dijit._Templated"],["require","dijit.MenuItem"],["require","dijit.PopupMenuItem"],["require","dijit.CheckedMenuItem"],["require","dijit.MenuSeparator"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dijit.Menu"]){_4._hasResource["dijit.Menu"]=true;_4.provide("dijit.Menu");_4.require("dojo.window");_4.require("dijit._Widget");_4.require("dijit._KeyNavContainer");_4.require("dijit._Templated");_4.require("dijit.MenuItem");_4.require("dijit.PopupMenuItem");_4.require("dijit.CheckedMenuItem");_4.require("dijit.MenuSeparator");_4.declare("dijit._MenuBase",[_5._Widget,_5._Templated,_5._KeyNavContainer],{parentMenu:null,popupDelay:500,startup:function(){if(this._started){return;}_4.forEach(this.getChildren(),function(_7){_7.startup();});this.startupKeyNavChildren();this.inherited(arguments);},onExecute:function(){},onCancel:function(_8){},_moveToPopup:function(_9){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled){this.focusedChild._onClick(_9);}else{var _a=this._getTopMenu();if(_a&&_a._isMenuBar){_a.focusNext();}}},_onPopupHover:function(_b){if(this.currentPopup&&this.currentPopup._pendingClose_timer){var _c=this.currentPopup.parentMenu;if(_c.focusedChild){_c.focusedChild._setSelected(false);}_c.focusedChild=this.currentPopup.from_item;_c.focusedChild._setSelected(true);this._stopPendingCloseTimer(this.currentPopup);}},onItemHover:function(_d){if(this.isActive){this.focusChild(_d);if(this.focusedChild.popup&&!this.focusedChild.disabled&&!this.hover_timer){this.hover_timer=setTimeout(_4.hitch(this,"_openPopup"),this.popupDelay);}}if(this.focusedChild){this.focusChild(_d);}this._hoveredChild=_d;},_onChildBlur:function(_e){this._stopPopupTimer();_e._setSelected(false);var _f=_e.popup;if(_f){this._stopPendingCloseTimer(_f);_f._pendingClose_timer=setTimeout(function(){_f._pendingClose_timer=null;if(_f.parentMenu){_f.parentMenu.currentPopup=null;}_5.popup.close(_f);},this.popupDelay);}},onItemUnhover:function(_10){if(this.isActive){this._stopPopupTimer();}if(this._hoveredChild==_10){this._hoveredChild=null;}},_stopPopupTimer:function(){if(this.hover_timer){clearTimeout(this.hover_timer);this.hover_timer=null;}},_stopPendingCloseTimer:function(_11){if(_11._pendingClose_timer){clearTimeout(_11._pendingClose_timer);_11._pendingClose_timer=null;}},_stopFocusTimer:function(){if(this._focus_timer){clearTimeout(this._focus_timer);this._focus_timer=null;}},_getTopMenu:function(){for(var top=this;top.parentMenu;top=top.parentMenu){}return top;},onItemClick:function(_12,evt){if(typeof this.isShowingNow=="undefined"){this._markActive();}this.focusChild(_12);if(_12.disabled){return false;}if(_12.popup){this._openPopup();}else{this.onExecute();_12.onClick(evt);}},_openPopup:function(){this._stopPopupTimer();var _13=this.focusedChild;if(!_13){return;}var _14=_13.popup;if(_14.isShowingNow){return;}if(this.currentPopup){this._stopPendingCloseTimer(this.currentPopup);_5.popup.close(this.currentPopup);}_14.parentMenu=this;_14.from_item=_13;var _15=this;_5.popup.open({parent:this,popup:_14,around:_13.domNode,orient:this._orient||(this.isLeftToRight()?{"TR":"TL","TL":"TR","BR":"BL","BL":"BR"}:{"TL":"TR","TR":"TL","BL":"BR","BR":"BL"}),onCancel:function(){_15.focusChild(_13);_15._cleanUp();_13._setSelected(true);_15.focusedChild=_13;},onExecute:_4.hitch(this,"_cleanUp")});this.currentPopup=_14;_14.connect(_14.domNode,"onmouseenter",_4.hitch(_15,"_onPopupHover"));if(_14.focus){_14._focus_timer=setTimeout(_4.hitch(_14,function(){this._focus_timer=null;this.focus();}),0);}},_markActive:function(){this.isActive=true;_4.replaceClass(this.domNode,"dijitMenuActive","dijitMenuPassive");},onOpen:function(e){this.isShowingNow=true;this._markActive();},_markInactive:function(){this.isActive=false;_4.replaceClass(this.domNode,"dijitMenuPassive","dijitMenuActive");},onClose:function(){this._stopFocusTimer();this._markInactive();this.isShowingNow=false;this.parentMenu=null;},_closeChild:function(){this._stopPopupTimer();var _16=this.focusedChild&&this.focusedChild.from_item;if(this.currentPopup){if(_5._curFocus&&_4.isDescendant(_5._curFocus,this.currentPopup.domNode)){this.focusedChild.focusNode.focus();}_5.popup.close(this.currentPopup);this.currentPopup=null;}if(this.focusedChild){this.focusedChild._setSelected(false);this.focusedChild._onUnhover();this.focusedChild=null;}},_onItemFocus:function(_17){if(this._hoveredChild&&this._hoveredChild!=_17){this._hoveredChild._onUnhover();}},_onBlur:function(){this._cleanUp();this.inherited(arguments);},_cleanUp:function(){this._closeChild();if(typeof this.isShowingNow=="undefined"){this._markInactive();}}});_4.declare("dijit.Menu",_5._MenuBase,{constructor:function(){this._bindings=[];},templateString:_4.cache("dijit","templates/Menu.html","<table class=\"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable\" role=\"menu\" tabIndex=\"${tabIndex}\" dojoAttachEvent=\"onkeypress:_onKeyPress\" cellspacing=\"0\">\r\n\t<tbody class=\"dijitReset\" dojoAttachPoint=\"containerNode\"></tbody>\r\n</table>\r\n"),baseClass:"dijitMenu",targetNodeIds:[],contextMenuForWindow:false,leftClickToOpen:false,refocus:true,postCreate:function(){if(this.contextMenuForWindow){this.bindDomNode(_4.body());}else{_4.forEach(this.targetNodeIds,this.bindDomNode,this);}var k=_4.keys,l=this.isLeftToRight();this._openSubMenuKey=l?k.RIGHT_ARROW:k.LEFT_ARROW;this._closeSubMenuKey=l?k.LEFT_ARROW:k.RIGHT_ARROW;this.connectKeyNavHandlers([k.UP_ARROW],[k.DOWN_ARROW]);},_onKeyPress:function(evt){if(evt.ctrlKey||evt.altKey){return;}switch(evt.charOrCode){case this._openSubMenuKey:this._moveToPopup(evt);_4.stopEvent(evt);break;case this._closeSubMenuKey:if(this.parentMenu){if(this.parentMenu._isMenuBar){this.parentMenu.focusPrev();}else{this.onCancel(false);}}else{_4.stopEvent(evt);}break;}},_iframeContentWindow:function(_18){var win=_4.window.get(this._iframeContentDocument(_18))||this._iframeContentDocument(_18)["__parent__"]||(_18.name&&_4.doc.frames[_18.name])||null;return win;},_iframeContentDocument:function(_19){var doc=_19.contentDocument||(_19.contentWindow&&_19.contentWindow.document)||(_19.name&&_4.doc.frames[_19.name]&&_4.doc.frames[_19.name].document)||null;return doc;},bindDomNode:function(_1a){_1a=_4.byId(_1a);var cn;if(_1a.tagName.toLowerCase()=="iframe"){var _1b=_1a,win=this._iframeContentWindow(_1b);cn=_4.withGlobal(win,_4.body);}else{cn=(_1a==_4.body()?_4.doc.documentElement:_1a);}var _1c={node:_1a,iframe:_1b};_4.attr(_1a,"_dijitMenu"+this.id,this._bindings.push(_1c));var _1d=_4.hitch(this,function(cn){return [_4.connect(cn,this.leftClickToOpen?"onclick":"oncontextmenu",this,function(evt){_4.stopEvent(evt);this._scheduleOpen(evt.target,_1b,{x:evt.pageX,y:evt.pageY});}),_4.connect(cn,"onkeydown",this,function(evt){if(evt.shiftKey&&evt.keyCode==_4.keys.F10){_4.stopEvent(evt);this._scheduleOpen(evt.target,_1b);}})];});_1c.connects=cn?_1d(cn):[];if(_1b){_1c.onloadHandler=_4.hitch(this,function(){var win=this._iframeContentWindow(_1b);cn=_4.withGlobal(win,_4.body);_1c.connects=_1d(cn);});if(_1b.addEventListener){_1b.addEventListener("load",_1c.onloadHandler,false);}else{_1b.attachEvent("onload",_1c.onloadHandler);}}},unBindDomNode:function(_1e){var _1f;try{_1f=_4.byId(_1e);}catch(e){return;}var _20="_dijitMenu"+this.id;if(_1f&&_4.hasAttr(_1f,_20)){var bid=_4.attr(_1f,_20)-1,b=this._bindings[bid];_4.forEach(b.connects,_4.disconnect);var _21=b.iframe;if(_21){if(_21.removeEventListener){_21.removeEventListener("load",b.onloadHandler,false);}else{_21.detachEvent("onload",b.onloadHandler);}}_4.removeAttr(_1f,_20);delete this._bindings[bid];}},_scheduleOpen:function(_22,_23,_24){if(!this._openTimer){this._openTimer=setTimeout(_4.hitch(this,function(){delete this._openTimer;this._openMyself({target:_22,iframe:_23,coords:_24});}),1);}},_openMyself:function(_25){var _26=_25.target,_27=_25.iframe,_28=_25.coords;if(_28){if(_27){var od=_26.ownerDocument,ifc=_4.position(_27,true),win=this._iframeContentWindow(_27),_29=_4.withGlobal(win,"_docScroll",_4);var cs=_4.getComputedStyle(_27),tp=_4._toPixelValue,_2a=(_4.isIE&&_4.isQuirks?0:tp(_27,cs.paddingLeft))+(_4.isIE&&_4.isQuirks?tp(_27,cs.borderLeftWidth):0),top=(_4.isIE&&_4.isQuirks?0:tp(_27,cs.paddingTop))+(_4.isIE&&_4.isQuirks?tp(_27,cs.borderTopWidth):0);_28.x+=ifc.x+_2a-_29.x;_28.y+=ifc.y+top-_29.y;}}else{_28=_4.position(_26,true);_28.x+=10;_28.y+=10;}var _2b=this;var _2c=_5.getFocus(this);function _2d(){if(_2b.refocus){_5.focus(_2c);}_5.popup.close(_2b);};_5.popup.open({popup:this,x:_28.x,y:_28.y,onExecute:_2d,onCancel:_2d,orient:this.isLeftToRight()?"L":"R"});this.focus();this._onBlur=function(){this.inherited("_onBlur",arguments);_5.popup.close(this);};},uninitialize:function(){_4.forEach(this._bindings,function(b){if(b){this.unBindDomNode(b.node);}},this);this.inherited(arguments);}});}}};});